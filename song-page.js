/*
jQuery Waypoints - v1.1.6
Copyright (c) 2011-2012 Caleb Troughton
Dual licensed under the MIT license and GPL license.
https://github.com/imakewebthings/jquery-waypoints/blob/master/MIT-license.txt
https://github.com/imakewebthings/jquery-waypoints/blob/master/GPL-license.txt
*/

function hideAllPopovers(){$(document).trigger("hide-popovers")}define("song-page/collaboration-intro",["jquery","jquery.cookie"],function(t){return function(){return t(".collaboration-intro").bind("closed",function(){return t.cookie("hide_collaboration_intro","true",{expires:356,path:"/"})})}}),function(t,e,r,o,n){var i=t(o),s="waypoint.reached",a=function(t,r){t.element.trigger(s,r),t.options.triggerOnce&&t.element[e]("destroy")},p=function(t,e){if(!e)return-1;for(var r=e.waypoints.length-1;r>=0&&e.waypoints[r].element[0]!==t[0];)r-=1;return r},l=[],c=function(e){t.extend(this,{element:t(e),oldScroll:0,waypoints:[],didScroll:!1,didResize:!1,doScroll:t.proxy(function(){var e=this.element.scrollTop(),o=e>this.oldScroll,n=this,i=t.grep(this.waypoints,function(t,r){return o?t.offset>n.oldScroll&&t.offset<=e:t.offset<=n.oldScroll&&t.offset>e}),s=i.length;this.oldScroll&&e||t[r]("refresh"),this.oldScroll=e,s&&(o||i.reverse(),t.each(i,function(t,e){(e.options.continuous||t===s-1)&&a(e,[o?"down":"up"])}))},this)}),t(e).bind("scroll.waypoints",t.proxy(function(){this.didScroll||(this.didScroll=!0,o.setTimeout(t.proxy(function(){this.doScroll(),this.didScroll=!1},this),t[r].settings.scrollThrottle))},this)).bind("resize.waypoints",t.proxy(function(){this.didResize||(this.didResize=!0,o.setTimeout(t.proxy(function(){t[r]("refresh"),this.didResize=!1},this),t[r].settings.resizeThrottle))},this)),i.load(t.proxy(function(){this.doScroll()},this))},u=function(e){var r=null;return t.each(l,function(t,o){if(o.element[0]===e)return r=o,!1}),r},d={init:function(o,n){return this.each(function(){var i,a=t.fn[e].defaults.context,d=t(this);n&&n.context&&(a=n.context),t.isWindow(a)||(a=d.closest(a)[0]),(i=u(a))||(i=new c(a),l.push(i));var h=p(d,i),f=h<0?t.fn[e].defaults:i.waypoints[h].options,m=t.extend({},f,n);m.offset="bottom-in-view"===m.offset?function(){return(t.isWindow(a)?t[r]("viewportHeight"):t(a).height())-t(this).outerHeight()}:m.offset,h<0?i.waypoints.push({element:d,offset:null,options:m}):i.waypoints[h].options=m,o&&d.bind(s,o),n&&n.handler&&d.bind(s,n.handler)}),t[r]("refresh"),this},remove:function(){return this.each(function(e,r){var o=t(r);t.each(l,function(t,e){var r=p(o,e);r>=0&&(e.waypoints.splice(r,1),e.waypoints.length||(e.element.unbind("scroll.waypoints resize.waypoints"),l.splice(t,1)))})})},destroy:function(){return this.unbind(s)[e]("remove")}},h={refresh:function(){t.each(l,function(e,o){var n=t.isWindow(o.element[0]),i=n?0:o.element.offset().top,s=n?t[r]("viewportHeight"):o.element.height(),p=n?0:o.element.scrollTop();t.each(o.waypoints,function(t,e){if(e){var r=e.options.offset,n=e.offset;if("function"==typeof e.options.offset)r=e.options.offset.apply(e.element);else if("string"==typeof e.options.offset){var l=parseFloat(e.options.offset);r=e.options.offset.indexOf("%")?Math.ceil(s*(l/100)):l}e.offset=e.element.offset().top-i+p-r,e.options.onlyOnScroll||(null!==n&&o.oldScroll>n&&o.oldScroll<=e.offset?a(e,["up"]):null!==n&&o.oldScroll<n&&o.oldScroll>=e.offset?a(e,["down"]):!n&&p>e.offset&&a(e,["down"]))}}),o.waypoints.sort(function(t,e){return t.offset-e.offset})})},viewportHeight:function(){return o.innerHeight?o.innerHeight:i.height()},aggregate:function(){var e=t();return t.each(l,function(r,o){t.each(o.waypoints,function(t,r){e=e.add(r.element)})}),e}};t.fn[e]=function(r){return d[r]?d[r].apply(this,Array.prototype.slice.call(arguments,1)):"function"!=typeof r&&r?"object"==typeof r?d.init.apply(this,[null,r]):void t.error("Method "+r+" does not exist on jQuery "+e):d.init.apply(this,arguments)},t.fn[e].defaults={continuous:!0,offset:0,triggerOnce:!1,context:o},t[r]=function(t){return h[t]?h[t].apply(this):h.aggregate()},t[r].settings={resizeThrottle:200,scrollThrottle:100},i.load(function(){t[r]("refresh")})}(jQuery,"waypoint","waypoints",window),define("jquery.waypoints",["jquery"],function(){}),define("song-page/collaboration-waypoint",["jquery","tracker","jquery.waypoints"],function(t,e){var r;return r=function(r,o){if("down"===o)return e.trackToGA("Collaboration","scrolled to reports and revisions block"),t(".error-report-item").length?setTimeout(function(){if("undefined"!=typeof _kiq&&null!==_kiq)return _kiq.push(["showSurvey",60719])},2e4):void 0},function(){return t(".error-reports-and-revisions").waypoint(r,{triggerOnce:!0})}}),define("text!templates/error-reports/song-reports.html",[],function(){return'<h2 class="headingWithIcon balloonIcon">Tab Error Reports</h2>\n<div class="new-error-report">\n  \x3c!-- NewErrorReportView --\x3e\n</div>\n<div class="no-reports">No error reports so far. Noticed an error in tab? Report it to help others out!</div>\n\x3c!-- ErrorReportsView --\x3e'}),define("text!templates/error-reports/sign-in-prompt.html",[],function(){return"<%= prompt %> to <%= action %>"});var extend=function(t,e){function r(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("error-reports/views/sign-in-prompt",["jquery","underscore","backbone","settings","text!templates/error-reports/sign-in-prompt.html"],function(t,e,r,o,n){return function(t){function r(t){this.options=t,r.__super__.constructor.apply(this,arguments)}return extend(r,t),r.prototype.className="sign-in-textarea-prompt",r.prototype.template=e.template(n),r.prototype.render=function(){return this.$el.html(this.template({prompt:o.signInPrompt,action:this.options.action})),this},r}(r.View)}),define("text!templates/error-reports/new.html",[],function(){return'<textarea placeholder="Describe specific tab error (wrong notes, bad timing, missing parts, etc)."></textarea>\n<input type="button" value="Submit Error Report" class="submit-report-button" />\n'});var extend=function(t,e){function r(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("error-reports/views/new",["jquery","underscore","backbone","tracker","settings","text!templates/error-reports/new.html"],function(t,e,r,o,n,i){return function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return extend(r,t),r.prototype.template=e.template(i),r.prototype.events={"click .submit-report-button":"addReport"},r.prototype.addReport=function(){var t;return o.trackToGA("Collaboration","clicked submit error report button"),t={message:this.$("textarea").val(),track:{id:n.trackId}},this.collection.create(t,{wait:!0}),this.$("textarea").val("")},r.prototype.render=function(){return this.$el.html(this.template()),n.userSignedIn?this.$(".sign-in-textarea-prompt").hide():this.$(".new-error-report").hide(),this},r}(r.View)}),define("text!templates/error-reports/item.html",[],function(){return'<div class="error-report-item">\n  <div class="votes-column">\n    <a class="vote-up"></a>\n    <div class="votes-count"><%= votesCount %></div>\n    <a class="vote-down"></a>\n  </div>\n  <div class="report-column">\n    <div class="message"><%= formattedMessage %></div>\n    <div class="reported-by">\n      <%= dateStr %> by <%  if(reportedBy) { %><a href="/a/wa/user?id=<%= reportedBy.id %>"><%- reportedBy.name %></a><% } else { %> Anonymous <% } %>\n      <span class="looking-at">looking at <%- trackTitle %></span>\n    </div>\n    <div class="actions">\n      <a class="comment-link">comment</a>\n      <a class="flag-link" href="#reportFlagModal">report</a>\n      <span class="flagged-label">flagged</span>\n      <div class = "moderator">\n        <a class="edit-link">edit</a>\n        <a class="delete-link">delete</a>\n      </div>\n    </div>\n    <div class="comments">\n      \x3c!-- ErrorReportCommentsView --\x3e\n      <div class="new-comment">\n        \x3c!-- NewErrorReportCommentView --\x3e\n      </div>\n    </div>\n  </div>\n</div>\n'});var extend=function(t,e){function r(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("error-reports/models/error-report-comment",["settings","backbone"],function(t,e){return function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return extend(r,e),r.prototype.urlRoot=t.apiURLPrefix+"/error_report_comments",r.prototype.validate=function(t){var e;if(""===(null!=(e=t.message)?e.trim():void 0))return"Message must not be blank"},r}(e.Model)});var extend=function(t,e){function r(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("error-reports/collections/error-report-comments",["jquery","underscore","backbone","error-reports/models/error-report-comment"],function(t,e,r,o){return function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.model=o,e}(r.Collection)}),define("text!templates/error-reports/edit.html",[],function(){return'<textarea></textarea>\n<input type="button" value="Save" class="save-button" />\nor <a class="cancel-link">Cancel</a>'});var extend=function(t,e){function r(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("error-reports/views/edit",["jquery","underscore","backbone","text!templates/error-reports/edit.html"],function(t,e,r,o){return function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return extend(r,t),r.prototype.className="edit-error-report",r.prototype.template=e.template(o),r.prototype.events={"click .save-button":"save","click .cancel-link":"cancel"},r.prototype.save=function(){return this.model.save({message:this.$("textarea").val()},{wait:!0}),tracker.trackToGA("Collaboration","saved edited error report")},r.prototype.cancel=function(){return this.model.trigger("editExited")},r.prototype.render=function(){return this.$el.html(this.template()),this.$("textarea").html(this.model.get("formattedMessage")),this},r}(r.View)}),define("text!templates/error-reports/flag-modal.html",[],function(){return'<div class="modal-header">\n  <a class="close" data-dismiss="modal">Ã—</a>\n  <h3>Flag error report for deletion</h3>\n</div>\n<div class="modal-body">  \n  <p>I am flagging this error report for deletion by moderator because it has one of these problems:   \n  </p>\n  <p>   \n    <ul class="error-report-flag-type-list">\n      <li><input type="radio" name="flag-type" id="NOT_AN_ERROR" value="NOT_AN_ERROR"/><label for="NOT_AN_ERROR">it is not an error report</label></li>\n      <li><input type="radio" name="flag-type" id="LOW_QUALITY" value="LOW_QUALITY"/><label for="LOW_QUALITY">it\'s of low quality</label></li>\n\t  <li><input type="radio" name="flag-type" id="DOESNT_BELONG_HERE" value="DOESNT_BELONG_HERE"/><label for="DOESNT_BELONG_HERE">it doesn\'t belong here</label></li>\n\t  <li><input type="radio" name="flag-type" id="ABUSIVE" value="ABUSIVE"/><label for="ABUSIVE">it\'s abusive</label></li>\n\t  <li><input type="radio" name="flag-type" id="DUPLICATE" value="DUPLICATE"/><label for="DUPLICATE">it is duplicate of another error report</label></li>\n\t  <li><input type="radio" name="flag-type" id="OTHER" value="OTHER"/><label for="OTHER">another reason (please leave comment)</label></li>\n    </ul>\n  </p>\n  <p>\n    Comment:<br/>\n    <textarea class="error-report-flag-comment"></textarea>\n  </p>\n  <div class="error-message"></div>\n</div>\n<div class="modal-footer">\n  <a class="button-medium anchor-button flag-button">Flag For Deletion</a>\n  or \n  <a href="#close" data-dismiss="modal" class="close-link">Close</a>\n</div>'});var extend=function(t,e){function r(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("error-reports/views/flag-modal",["jquery","underscore","backbone","tracker","text!templates/error-reports/flag-modal.html"],function(t,e,r,o,n){return function(r){function i(){return i.__super__.constructor.apply(this,arguments)}return extend(i,r),i.prototype.id="reportFlagModal",i.prototype.className="modal hide flag-modal",i.prototype.template=e.template(n),i.prototype.events={"click .flag-button":"flag"},i.prototype.flag=function(){var e;return o.trackToGA("Collaboration","clicked flag error report button"),t(".error-report-flag-type-list input:checked").length>0?"OTHER"===t(".error-report-flag-type-list input:checked").val()&&""===t(".flag-modal .error-report-flag-comment").val().trim()?(this.$(".error-message").html("Please describe problem in comment area."),o.trackToGA("Collaboration","clicked flag error report button with another reason and empty comment")):(this.$(".error-message").empty(),e=this.model.url()+"/flag",t.post(e,{flagType:this.$(".error-report-flag-type-list input:checked").val(),comment:this.$(".error-report-flag-comment").val()},function(t){return function(e){return t.$el.modal("hide"),t.model.set({flagged:!0}),t.undelegateEvents()}}(this))):(this.$(".error-message").html("Please select reason of the flag."),o.trackToGA("Collaboration","clicked flag error report button without problem choosen"))},i.prototype.render=function(){return this.$el.html(this.template()),this},i}(r.View)}),define("text!templates/error-reports/comments/item.html",[],function(){return'<div class="message"><%- message %></div>\n<div class="author"><%= dateStr %> by <a href="/a/wa/user?id=<%= author.id %>"><%- author.name %></a></div>\n'});var extend=function(t,e){function r(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("error-reports/views/comments/item",["jquery","underscore","backbone","text!templates/error-reports/comments/item.html"],function(t,e,r,o){return function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return extend(r,t),r.prototype.tagName="li",r.prototype.template=e.template(o),r.prototype.render=function(){return this.$el.html(this.template(this.model.toJSON())),this},r}(r.View)});var extend=function(t,e){function r(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("error-reports/views/comments/list",["jquery","underscore","backbone","error-reports/views/comments/item"],function(t,e,r,o){return function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.tagName="ul",e.prototype.initialize=function(){return this.collection.bind("add",this.render,this)},e.prototype.render=function(){return this.$el.empty(),this.collection.each(function(t){return function(e){var r;return r=new o({model:e}),t.$el.append(r.render().el)}}(this)),this},e}(r.View)}),define("text!templates/error-reports/comments/new.html",[],function(){return'<div class="new-comment">\n  <textarea></textarea>\n  <input type="button" value="Add Comment" class="add-comment-button"/>\n</div>\n'});var extend=function(t,e){function r(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("error-reports/views/comments/new",["jquery","underscore","backbone","tracker","text!templates/error-reports/comments/new.html"],function(t,e,r,o,n){return function(t){function r(t){this.options=t,r.__super__.constructor.apply(this,arguments)}return extend(r,t),r.prototype.template=e.template(n),r.prototype.events={"click .add-comment-button":"addComment"},r.prototype.addComment=function(){var t;return o.trackToGA("Collaboration","clicked add comment button"),t={message:this.$("textarea").val(),errorReport:this.options.report},this.collection.create(t,{wait:!0}),this.$("textarea").val("")},r.prototype.render=function(){return this.$el.html(this.template()),this},r}(r.View)}),require(["jquery"],function(t){var e=t(document);e.ready(function(){var r=!1,o=!1,n={html:!0,trigger:"manual",animation:!0,container:"body"},i=function(){t("[rel=sticky-popover]").each(function(){t(this).popover(n).popover("hide")}),r=o=!1};e.on("click","[rel=sticky-popover]",function(e){t(this).popover(n).popover("show"),r=!0,e.preventDefault()}),e.click(function(t){r&&(o?i():o=!0)}),e.keydown(function(t){r&&27==t.keyCode&&i()}),e.on("hide-popovers",function(t){r&&i()})}),e.ready(function(){var r=!1,o=null,n=null,i="[rel=sticky-hover-popover]",s={html:!0,trigger:"manual",animation:!0,container:"body",placement:"top"},a=function(){null!=o&&(clearTimeout(o),o=null)},p=function(){r=!1,a(),t(n).popover(s).popover("destroy")},l=function(e){var o=e.currentTarget;n!=o&&(r&&p(),n=o),r?a():(r=!0,n=o,t(o).popover(s).popover("show")),e.preventDefault()};e.on("mouseenter mouseleave",i,l),e.on("mouseenter",".popover",function(t){r&&a(),t.preventDefault()}),e.on("mouseleave",i+", .popover",function(t){null==o&&r&&(o=setTimeout(p,200))}),e.keydown(function(t){r&&27==t.keyCode&&p()}),e.on("hide-popovers",function(t){r&&p()})})}),define("libs/sticky-popover",function(){});var extend=function(t,e){function r(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("error-reports/views/item",["jquery","underscore","backbone","tracker","settings","text!templates/error-reports/item.html","error-reports/collections/error-report-comments","error-reports/views/edit","error-reports/views/flag-modal","error-reports/views/comments/list","error-reports/views/comments/new","error-reports/views/sign-in-prompt","bootstrap","libs/sticky-popover"],function(t,e,r,o,n,i,s,a,p,l,c,u){return function(r){function d(){return d.__super__.constructor.apply(this,arguments)}return extend(d,r),d.prototype.tagName="li",d.prototype.template=e.template(i),d.prototype.events=function(){var e;return e={"click .flag-link":"openFlagModal","mouseover .flag-link":"trackFlagLinkMouseover","click .comment-link":"toggleComments","click .edit-link":"edit","click .delete-link":"delete"},n.userSignedIn?t.extend(e,{"click .vote-up":"voteUp","click .vote-down":"voteDown"}):t.extend(e,{"click .vote-up":"trackVoteUpByGuest","click .vote-down":"trackVoteDownByGuest"}),e},d.prototype.initialize=function(){return this.model.bind("change",this.render,this),this.model.bind("editExited",this.render,this),this.comments=new s(this.model.get("comments")),this.flagView=new p({model:this.model}),this.comments.bind("add",this.render,this),this.showComments=!1},d.prototype.render=function(){var t,e,r;return this.$el.html(this.template(this.model.toJSON())),this.$(".comments").toggle(this.showComments),this.setCommentsLinkText(),this.comments.url=this.model.url()+"/comments",t=new l({collection:this.comments}),this.$(".new-comment").before(t.render().el),e=n.userSignedIn?new c({collection:this.comments,report:this.model}):new u({action:"post a comment"}),this.$(".new-comment").append(e.render().el),"UP"===this.model.get("votedByActor")&&this.$(".vote-up").addClass("voted"),"DOWN"===this.model.get("votedByActor")&&this.$(".vote-down").addClass("voted"),n.userSignedIn||(r=new u({action:"vote"}).render().$el.html(),this.$("[class^='vote-']").attr("rel","sticky-popover").attr("data-content",r).addClass("sign-in-prompt")),null===this.model.get("trackTitle")&&this.$(".looking-at").hide(),this.model.get("flagged")?(this.$(".flag-link").hide(),this.$(".flagged-label").show()):this.model.get("reportedByActor")?this.$(".flag-link").hide():this.$(".flag-link").tooltip({title:"Flag error report for deletion by moderator because it is offtopic, abusive, low quality, duplicate, etc"}),(n.actorIsModerator||this.model.get("reportedByActor"))&&this.$(".moderator").show(),this},d.prototype.setCommentsLinkText=function(){var t;if((t=this.comments.size())>0)return this.$(".comment-link").text((this.showComments?"hide":"show")+" "+t+" "+(1===t?"comment":"comments"))},d.prototype.toggleComments=function(){var t;return t=this.showComments?"hide":"show",o.trackToGA("Collaboration","clicked "+t+" error report comments link"),this.$(".comments").toggle(),this.showComments=!this.showComments,this.setCommentsLinkText()},d.prototype.voteUp=function(t){return this.vote(t,"up")},d.prototype.voteDown=function(t){return this.vote(t,"down")},d.prototype.vote=function(e,r){var n;return t(e.target).hasClass("voted")?o.trackToGA("Collaboration","clicked undo error report vote "+r+" button"):o.trackToGA("Collaboration","clicked error report vote "+r+" button (by signed in user)"),t(e.target).toggleClass("voted"),n=this.model.url()+"/vote_"+r,t.get(n,function(t){return function(e){return t.model.set(e)}}(this))},d.prototype.trackVoteUpByGuest=function(){return o.trackToGA("Collaboration","clicked error report vote up button (by guest)")},d.prototype.trackVoteDownByGuest=function(){return o.trackToGA("Collaboration","clicked error report vote down button (by guest)")},d.prototype.openFlagModal=function(){var e;return o.trackToGA("Collaboration","clicked flag error report link"),e=this.flagView.render().el,this.$el.append(e),t(e).modal("show")},d.prototype.trackFlagLinkMouseover=function(){return o.trackToGA("Collaboration","moved mouse over flag error report link")},d.prototype.edit=function(){var t;return this.$(".report-column > .message").hide(),this.$(".edit-link").hide(),t=new a({model:this.model}),this.$(".report-column > .message").after(t.render().el),o.trackToGA("Collaboration","clicked edit error report link")},d.prototype.delete=function(){return this.model.markAsDeleted(function(e){return function(){return e.$el.fadeOut("fast",function(){return t(this).remove()})}}(this)),o.trackToGA("Collaboration","marked report as deleted (by "+n.actorEmail+")")},d}(r.View)});var extend=function(t,e){function r(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("error-reports/views/list",["jquery","underscore","backbone","error-reports/views/item"],function(t,e,r,o){return function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.tagName="ul",e.prototype.className="active-error-reports",e.prototype.initialize=function(){return this.collection.bind("add",this.render,this),this.collection.bind("remove",this.render,this)},e.prototype.render=function(){return this.$el.empty(),this.collection.each(function(t){return function(e){var r;return r=new o({model:e}),t.$el.append(r.render().el)}}(this)),this},e}(r.View)});var extend=function(t,e){function r(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("error-reports/views/song-reports",["jquery","underscore","backbone","settings","text!templates/error-reports/song-reports.html","error-reports/views/sign-in-prompt","error-reports/views/new","error-reports/views/list"],function(t,e,r,o,n,i,s,a){return function(r){function p(){return p.__super__.constructor.apply(this,arguments)}return extend(p,r),p.prototype.className="error-reports",p.prototype.template=e.template(n),p.prototype.initialize=function(){return this.newReportView=new s({collection:this.collection}),this.signInPrompt=new i({action:"post an error report"}),this.reportsView=new a({collection:this.collection}),this.collection.bind("reset",this.render,this),this.collection.bind("add remove",this.toggleNoReportsMessage,this)},p.prototype.render=function(){return this.$el.html(this.template()),this.$(".new-error-report").append(o.userSignedIn?this.newReportView.render().el:this.signInPrompt.render().el),this.$(".new-error-report").after(this.reportsView.render().el),this.toggleNoReportsMessage(),t(".error-reports").append(this.$el),this},p.prototype.toggleNoReportsMessage=function(){return this.$(".no-reports").toggle(this.collection.isEmpty())},p}(r.View)});var extend=function(t,e){function r(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("error-reports/models/error-report",["settings","jquery","backbone"],function(t,e,r){return function(r){function o(){return o.__super__.constructor.apply(this,arguments)}return extend(o,r),o.prototype.urlRoot=t.apiURLPrefix+"/error_reports",o.prototype.defaults={votesCount:0},o.prototype.validate=function(t){var e;if(""===(null!=(e=t.message)?e.trim():void 0))return"Message must not be blank"},o.prototype.markAsDeleted=function(t){return e.get(this.url()+"/mark_as_deleted",t)},o}(r.Model)});var extend=function(t,e){function r(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("error-reports/collections/error-reports",["jquery","underscore","backbone","settings","error-reports/models/error-report"],function(t,e,r,o,n){return function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.url=function(){return o.apiURLPrefix+"/tracks/"+o.trackId+"/error_reports"},e.prototype.model=n,e}(r.Collection)}),require(["jquery","settings","song-page/collaboration-intro","song-page/collaboration-waypoint","error-reports/views/song-reports","error-reports/collections/error-reports"],function(t,e,r,o,n,i){var s;return window.selectTrack=function(r){var o;return o=r.split("=")[1],t.get(e.apiURLPrefix+"/tracks/"+e.trackId+"/track_with_position/"+o,function(t){return e.trackId=t})},s=function(){return t(document).ajaxError(function(e,r,o,n){var i,s;return log.error("XHR error: status "+r.status+", response '"+r.responseText+"', exception '"+n+"'"),i=0===r.status?"The server could not be contacted.":403===r.status?"Login is required for this action.":500<=(s=r.status)&&s<=600?"There was an error on the server.":void 0,t("#error-message span").text(i),t("#error-message").slideDown()})},t.domParsed(function(){var t,a;return s(),t=new i(e.errorReports),a=new n({collection:t}),a.render(),r(),o()})}),define("song-page",function(){});